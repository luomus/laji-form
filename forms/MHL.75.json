{
  "schema": {
    "type": "object",
    "properties": {
      "editors": {
        "type": "array",
        "items": {
          "type": "string"
        },
        "title": "Muokkausoikeus"
      },
      "notes": {
        "type": "string",
        "title": "Huomautukset"
      },
      "gatheringEvent": {
        "type": "object",
        "properties": {
          "leg": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "title": "Laskijat"
          },
          "legPublic": {
            "type": "boolean",
            "title": "Laskijan nimi näkyy tuloksissa julkisena",
            "default": true
          },
          "dateBegin": {
            "type": "string",
            "title": "Laskentapäivämäärä"
          },
          "timeStart": {
            "type": "string",
            "title": "Aloitusaika"
          },
          "timeEnd": {
            "type": "string",
            "title": "Lopetusaika"
          },
          "namedPlaceNotes": {
            "type": "string",
            "title": "Reitin kuvaus"
          },
          "censusHinderedByEnviromentalFactors": {
            "type": "boolean",
            "title": "Sääolot (tms) haittasivat"
          },
          "taxonCensus": {
            "type": "array",
            "items": {
              "type": "object",
              "properties": {
                "censusTaxonID": {
                  "type": "string",
                  "title": "Laskettu taksoni"
                },
                "censusTaxonSetID": {
                  "type": "string",
                  "oneOf": [
                    {
                      "const": "",
                      "title": ""
                    },
                    {
                      "const": "MX.taxonSetSykeButterflyCensusPapilionoidea",
                      "title": "SYKEn päiväperhosseuranta: Päiväperhoset"
                    },
                    {
                      "const": "MX.taxonSetSykeButterflyCensusOther",
                      "title": "SYKEn päiväperhosseuranta: Muut suurperhoset"
                    },
                    {
                      "const": "MX.taxonSetWaterbirdWaterbirds",
                      "title": "Vesilintulaskenta: Vesilinnut"
                    },
                    {
                      "const": "MX.taxonSetWaterbirdWaders",
                      "title": "Vesilintulaskenta: Kahlaajalinnut"
                    },
                    {
                      "const": "MX.taxonSetWaterbirdGulls",
                      "title": "Vesilintulaskenta: Lokkilinnut"
                    },
                    {
                      "const": "MX.taxonSetWaterbirdPasserines",
                      "title": "Vesilintulaskenta: Varpuslinnut"
                    },
                    {
                      "const": "MX.taxonSetWaterbirdAmphibia",
                      "title": "Vesilintulaskenta: Sammakkoeläimet"
                    },
                    {
                      "const": "MX.taxonSetSykeBumblebee",
                      "title": "SYKEn kimalaisseuranta"
                    },
                    {
                      "const": "MVL.1201",
                      "title": "Kevätseurantalajit"
                    },
                    {
                      "const": "MX.taxonSetSykeBumblebeeOther",
                      "title": "Syken kimalaistutkimus: Ylemmät taksonit"
                    },
                    {
                      "const": "MX.taxonSetBirdAtlasCommon",
                      "title": "Lintuatlas: yleiset linnut"
                    }
                  ],
                  "title": "Laskettu taksonijoukko"
                },
                "taxonCensusType": {
                  "type": "string",
                  "oneOf": [
                    {
                      "const": "MY.taxonCensusTypeCounted",
                      "title": "Määritetty ja laskettu yksilöt kaikista lajeista"
                    },
                    {
                      "const": "MY.taxonCensusTypeNotCounted",
                      "title": "Määritetty kaikki lajit, yksilömäärää ei arvioitu"
                    }
                  ],
                  "title": "Laskennan kattavuus",
                  "default": ""
                }
              },
              "required": [
                "taxonCensusType"
              ]
            },
            "title": "",
            "default": [
              {
                "censusTaxonID": "MX.37612",
                "taxonCensusType": "MY.taxonCensusTypeNotCounted"
              },
              {
                "censusTaxonSetID": "MX.taxonSetWaterbirdWaterbirds",
                "taxonCensusType": "MY.taxonCensusTypeNotCounted"
              },
              {
                "censusTaxonSetID": "MX.taxonSetWaterbirdGulls",
                "taxonCensusType": "MY.taxonCensusTypeNotCounted"
              }
            ]
          }
        },
        "required": [
          "censusHinderedByEnviromentalFactors"
        ],
        "title": ""
      },
      "gatherings": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "geometry": {
              "type": "object",
              "properties": {},
              "title": "Koordinaatit"
            },
            "notes": {
              "type": "string",
              "title": "Huomautukset"
            },
            "gatheringFact": {
              "type": "object",
              "properties": {
                "pointCountHabitat": {
                  "type": "string",
                  "oneOf": [
                    {
                      "const": "",
                      "title": ""
                    },
                    {
                      "const": "MY.pointCountHabitat0",
                      "title": "Tuntematon (0)"
                    },
                    {
                      "const": "MY.pointCountHabitat1",
                      "title": "Kuusimetsä (1)"
                    },
                    {
                      "const": "MY.pointCountHabitat2",
                      "title": "Mäntymetsä (2)"
                    },
                    {
                      "const": "MY.pointCountHabitat3",
                      "title": "Lehtimetsä (3)"
                    },
                    {
                      "const": "MY.pointCountHabitat4",
                      "title": "Sekametsä (4)"
                    },
                    {
                      "const": "MY.pointCountHabitat5",
                      "title": "Lehtipensaikko (5)"
                    },
                    {
                      "const": "MY.pointCountHabitat6",
                      "title": "Havupuutaimikko (6)"
                    },
                    {
                      "const": "MY.pointCountHabitat7",
                      "title": "Hakkuuaukea (7)"
                    },
                    {
                      "const": "MY.pointCountHabitat8",
                      "title": "Räme (8)"
                    },
                    {
                      "const": "MY.pointCountHabitat9",
                      "title": "Avosuo (9)"
                    },
                    {
                      "const": "MY.pointCountHabitat10",
                      "title": "Rantaniitty (10)"
                    },
                    {
                      "const": "MY.pointCountHabitat11",
                      "title": "Pelto (11)"
                    },
                    {
                      "const": "MY.pointCountHabitat12",
                      "title": "Maaseutuasutus (12)"
                    },
                    {
                      "const": "MY.pointCountHabitat13",
                      "title": "Puisto (13)"
                    },
                    {
                      "const": "MY.pointCountHabitat14",
                      "title": "Kaupunkiasutus (14)"
                    },
                    {
                      "const": "MY.pointCountHabitat15",
                      "title": "Tunturikoivikko (15)"
                    },
                    {
                      "const": "MY.pointCountHabitat16",
                      "title": "Tunturipaljakka (16)"
                    },
                    {
                      "const": "MY.pointCountHabitat17",
                      "title": "Muu (17)"
                    }
                  ],
                  "title": "Biotooppi"
                }
              },
              "required": [
                "pointCountHabitat"
              ],
              "title": ""
            },
            "units": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "recordBasis": {
                    "type": "string",
                    "oneOf": [
                      {
                        "const": "",
                        "title": ""
                      },
                      {
                        "const": "MY.recordBasisPreservedSpecimen",
                        "title": "Näyte"
                      },
                      {
                        "const": "MY.recordBasisHumanObservation",
                        "title": "Havaittu"
                      },
                      {
                        "const": "MY.recordBasisHumanObservationSeen",
                        "title": "Nähty"
                      },
                      {
                        "const": "MY.recordBasisHumanObservationHeard",
                        "title": "Kuultu"
                      },
                      {
                        "const": "MY.recordBasisHumanObservationHandled",
                        "title": "Käsitelty (otettu kiinni, ei näytettä)"
                      },
                      {
                        "const": "MY.recordBasisHumanObservationPhoto",
                        "title": "Valokuvattu"
                      },
                      {
                        "const": "MY.recordBasisHumanObservationAudio",
                        "title": "Äänitetty"
                      },
                      {
                        "const": "MY.recordBasisHumanObservationVideo",
                        "title": "Videoitu"
                      },
                      {
                        "const": "MY.recordBasisHumanObservationIndirect",
                        "title": "Epäsuora havainto (jäljet, ulosteet, yms)"
                      },
                      {
                        "const": "MY.recordBasisMachineObservation",
                        "title": "Laitteen tekemä havainto"
                      },
                      {
                        "const": "MY.recordBasisMachineObservationVideo",
                        "title": "Laitteen tekemä videotallenne"
                      },
                      {
                        "const": "MY.recordBasisMachineObservationAudio",
                        "title": "Laitteen tekemä äänitallenne"
                      },
                      {
                        "const": "MY.recordBasisMachineObservationGeologger",
                        "title": "Geopaikannin"
                      },
                      {
                        "const": "MY.recordBasisMachineObservationSatelliteTransmitter",
                        "title": "Satelliittipaikannus"
                      },
                      {
                        "const": "MY.recordBasisFossilSpecimen",
                        "title": "Fossiili"
                      },
                      {
                        "const": "MY.recordBasisSubfossilSpecimen",
                        "title": "Subfossiili"
                      },
                      {
                        "const": "MY.recordBasisLivingSpecimen",
                        "title": "Elävä näyte"
                      },
                      {
                        "const": "MY.recordBasisMicrobialSpecimen",
                        "title": "Mikrobinäyte"
                      },
                      {
                        "const": "MY.recordBasisLiterature",
                        "title": "Kirjallisuustieto"
                      },
                      {
                        "const": "MY.recordBasisMaterialSample",
                        "title": "Materiaalinäyte"
                      },
                      {
                        "const": "MY.recordBasisSubfossilSpecimenAmberInclusion",
                        "title": "Meripihkafossiili"
                      }
                    ],
                    "title": "Havainnointitapa",
                    "default": "MY.recordBasisHumanObservation"
                  },
                  "identifications": {
                    "type": "array",
                    "items": {
                      "type": "object",
                      "properties": {
                        "taxonID": {
                          "type": "string",
                          "title": "Taksonin vaihtoehtoisia tunnisteita"
                        },
                        "taxonVerbatim": {
                          "type": "string",
                          "title": "Laji"
                        }
                      },
                      "required": []
                    },
                    "minItems": 1,
                    "maxItems": 1,
                    "title": ""
                  },
                  "unitFact": {
                    "type": "object",
                    "properties": {
                      "pairCountInner": {
                        "type": "integer",
                        "minimum": 0,
                        "title": "Pari sisällä"
                      },
                      "pairCountOuter": {
                        "type": "integer",
                        "minimum": 0,
                        "title": "Pari ulkona"
                      },
                      "pointCountFlock": {
                        "type": "string",
                        "title": "Parvien koot"
                      }
                    },
                    "required": [],
                    "title": ""
                  },
                  "atlasCode": {
                    "type": "string",
                    "oneOf": [
                      {
                        "const": "",
                        "title": ""
                      },
                      {
                        "const": "MY.atlasCodeEnum1",
                        "title": "1 Epätodennäköinen pesintä: havaittu lajin yksilö, havainto ei viittaa pesintään."
                      },
                      {
                        "const": "MY.atlasCodeEnum2",
                        "title": "2 Mahdollinen pesintä: yksittäinen lintu kerran, on sopivaa pesimäympäristöä."
                      },
                      {
                        "const": "MY.atlasCodeEnum3",
                        "title": "3 Mahdollinen pesintä: pari kerran, on sopivaa pesimäympäristöä."
                      },
                      {
                        "const": "MY.atlasCodeEnum4",
                        "title": "4 Todennäköinen pesintä: koiras reviirillä (esim. laulaa) eri päivinä."
                      },
                      {
                        "const": "MY.atlasCodeEnum5",
                        "title": "5 Todennäköinen pesintä: naaras tai pari reviirillä eri päivinä."
                      },
                      {
                        "const": "MY.atlasCodeEnum6",
                        "title": "6 Todennäköinen pesintä: linnun tai parin havainto viittaa vahvasti pesintään."
                      },
                      {
                        "const": "MY.atlasCodeEnum61",
                        "title": "61 Todennäköinen pesintä: lintu tai pari käy usein todennäköisellä pesäpaikalla."
                      },
                      {
                        "const": "MY.atlasCodeEnum62",
                        "title": "62 Todennäköinen pesintä: lintu tai pari rakentaa pesää tai vie pesämateriaalia."
                      },
                      {
                        "const": "MY.atlasCodeEnum63",
                        "title": "63 Todennäköinen pesintä: lintu tai pari varoittelee ehkä pesästä tai poikueesta."
                      },
                      {
                        "const": "MY.atlasCodeEnum64",
                        "title": "64 Todennäköinen pesintä: lintu tai pari houkuttelee pois ehkä pesältä / poikueelta."
                      },
                      {
                        "const": "MY.atlasCodeEnum65",
                        "title": "65 Todennäköinen pesintä: lintu tai pari hyökkäilee, lähellä ehkä pesä / poikue."
                      },
                      {
                        "const": "MY.atlasCodeEnum66",
                        "title": "66 Todennäköinen pesintä; Nähty pesä, jossa samanvuotista rakennusmateriaalia tai ravintojätettä; ei kuitenkaan varmaa todistetta munista tai poikasista"
                      },
                      {
                        "const": "MY.atlasCodeEnum7",
                        "title": "7 Varma pesintä: havaittu epäsuora todiste varmasta pesinnästä."
                      },
                      {
                        "const": "MY.atlasCodeEnum71",
                        "title": "71 Varma pesintä: nähty pesässä saman vuoden munia, kuoria, jäänteitä. Voi olla epäonnistunut."
                      },
                      {
                        "const": "MY.atlasCodeEnum72",
                        "title": "72 Varma pesintä: käy pesällä pesintään viittaavasti. Munia / poikasia ei havaita (kolo tms.)."
                      },
                      {
                        "const": "MY.atlasCodeEnum73",
                        "title": "73 Varma pesintä: juuri lentokykyiset poikaset tai untuvikot oletettavasti ruudulta."
                      },
                      {
                        "const": "MY.atlasCodeEnum74",
                        "title": "74 Varma pesintä: emo kantaa ruokaa tai poikasten ulosteita, pesintä oletettavasti ruudulla."
                      },
                      {
                        "const": "MY.atlasCodeEnum75",
                        "title": "75 Varma pesintä; Havaittu epäsuora todiste varmasta pesinnästä: nähty pesässä hautova emo"
                      },
                      {
                        "const": "MY.atlasCodeEnum8",
                        "title": "8 Varma pesintä: havaittu suora todiste varmasta pesinnästä."
                      },
                      {
                        "const": "MY.atlasCodeEnum81",
                        "title": "81 Varma pesintä: kuultu poikasten ääntelyä pesässä (kolo / pesä korkealla)."
                      },
                      {
                        "const": "MY.atlasCodeEnum82",
                        "title": "82 Varma pesintä: nähty pesässä munia tai poikasia."
                      }
                    ],
                    "title": "Pesimävarmuusindeksi"
                  }
                },
                "required": []
              },
              "uniqueItems": false,
              "title": "Havainnot"
            }
          },
          "required": []
        },
        "title": ""
      }
    },
    "required": [
      "gatherings"
    ]
  },
  "excludeFromCopy": [
    "$.gatheringEvent.dateBegin",
    "$.gatheringEvent.timeStart",
    "$.gatheringEvent.timeEnd",
    "$.gatheringEvent.censusHinderedByEnviromentalFactors",
    "$.gatheringEvent.taxonCensus",
    "$.gatherings[*].units"
  ],
  "id": "MHL.75",
  "name": "Pistelaskenta",
  "category": "MHL.categoryBirdMonitoringSchemes",
  "supportedLanguage": [
    "fi"
  ],
  "language": "fi",
  "title": "Pistelaskenta",
  "collectionID": "HR.157",
  "description": "Tämä on Luonnontieteellisen keskusmuseon Linnustonseurannan maalintujen pistelaskentojen havaintojen ilmoitusjärjestelmä. Lisätietoa, laskentaohjeita ja tuloksia löydät Linnustonseurannan sivuilta: <a  rel=\"noopener noreferrer\" href=\"https://www.luomus.fi/fi/pesimalintujen-linja-pistelaskenta\" target=\"_blank\">https://www.luomus.fi/fi/pesimalintujen-linja-pistelaskenta</a>",
  "logo": "https://cdn.laji.fi/images/logos/pistelaskenta.jpg",
  "options": {
    "periods": [
      "04-15/07-15"
    ],
    "instructions": {
      "fi": "https://laji.fi/theme/pistelaskenta",
      "en": "https://laji.fi/en/theme/pistelaskenta",
      "sv": "https://laji.fi/sv/theme/pistelaskenta"
    },
    "viewerType": "MHL.viewerTypeBirdPointCount",
    "namedPlaceOptions": {
      "useLabel": "Ilmoita uusi laskenta tältä reitiltä",
      "infoFields": [
        "name",
        "notes"
      ],
      "startWithMap": true,
      "useAcceptedDocument": true,
      "listColumns": [
        "$.alternativeIDs[0]",
        "$.name",
        "$.prepopulatedDocument.gatheringEvent.dateBegin"
      ],
      "chooseDescription": "Aloita valitsemalla reitti alta. Uuden reitin perustaminen: Ole ensin yhteydessä Linnustonseurantaan <a href='mailto:linnustonseuranta@luomus.fi'>linnustonseuranta@luomus.fi</a>",
      "copyLatestDocumentToNamedPlace": true
    },
    "saveLabel": "Tallenna havainnot",
    "cancelLabel": "Poistu tallentamatta",
    "draftLabel": "Tallenna julkaisematta",
    "useNamedPlaces": true,
    "hasAdmins": true,
    "adminLockable": true,
    "warnEditingOldDocument": true
  },
  "uiSchema": {
    "editors": {
      "items": {},
      "ui:help": "Jos lisäät tälle lomakkeelle uuden havainnoijan, joka on profiilissasi luokiteltu kaveriksesi, voit antaa hänelle oikeuden muokata retkikertomusta. Muokkausoikeuden haltijoille kaikki lomakkeeseen tallennetut havainnot näkyvät myös heidän omina havaintoinaan.",
      "ui:options": {
        "allowUndefined": false
      }
    },
    "gatheringEvent": {
      "leg": {
        "items": {},
        "ui:widget": "AutosuggestWidget",
        "ui:help": "Laskijan nimi, muodossa: etunimi sukunimi",
        "ui:options": {
          "autosuggestField": "friends",
          "allowNonsuggestedValue": true,
          "suggestionReceive": "key",
          "preventTypingPattern": "^MA\\.\\d+$"
        }
      },
      "taxonCensus": {
        "items": {},
        "ui:field": "MultiAnyToBooleanField",
        "ui:options": {
          "groups": [
            {
              "label": "Kaikki havaitut nisäkkäät kirjattu",
              "ui:help": "Valitse <i>Kyllä</i>, vaikka et olisi havainnut yhtään nisäkästä, mutta kiinnitit näiden havainnointiin kuitenkin huomiota",
              "trueValue": {
                "censusTaxonID": "MX.37612",
                "taxonCensusType": "MY.taxonCensusTypeCounted"
              },
              "falseValue": {
                "censusTaxonID": "MX.37612",
                "taxonCensusType": "MY.taxonCensusTypeNotCounted"
              },
              "allowUndefined": false
            },
            {
              "label": "Kaikki havaitut vesilinnut kirjattu",
              "ui:help": "Valitse <i>Kyllä</i>, vaikka et olisi havainnut yhtään vesilintua, mutta kiinnitit näiden havainnointiin kuitenkin huomiota",
              "trueValue": {
                "censusTaxonSetID": "MX.taxonSetWaterbirdWaterbirds",
                "taxonCensusType": "MY.taxonCensusTypeCounted"
              },
              "falseValue": {
                "censusTaxonSetID": "MX.taxonSetWaterbirdWaterbirds",
                "taxonCensusType": "MY.taxonCensusTypeNotCounted"
              },
              "allowUndefined": false
            },
            {
              "label": "Kaikki havaitut lokkilinnut kirjattu",
              "ui:help": "Valitse <i>Kyllä</i>, vaikka et olisi havainnut yhtään lokkilintua, mutta kiinnitit näiden havainnointiin kuitenkin huomiota",
              "trueValue": {
                "censusTaxonSetID": "MX.taxonSetWaterbirdGulls",
                "taxonCensusType": "MY.taxonCensusTypeCounted"
              },
              "falseValue": {
                "censusTaxonSetID": "MX.taxonSetWaterbirdGulls",
                "taxonCensusType": "MY.taxonCensusTypeNotCounted"
              },
              "allowUndefined": false
            }
          ]
        }
      },
      "ui:field": "NestField",
      "ui:classNames": "well well-sm",
      "ui:order": [
        "*",
        "legPublic",
        "eventTime",
        "censusHinderedByEnviromentalFactors",
        "taxonCensus",
        "namedPlaceNotes",
        "notes"
      ],
      "ui:options": {
        "nests": {
          "legEditor": {
            "fields": [
              "leg",
              "editors"
            ],
            "rootUiSchema": {
              "ui:field": "NestField",
              "ui:options": {
                "nests": {
                  "_legEditor": {
                    "fields": [
                      "leg",
                      "editors"
                    ],
                    "title": "",
                    "rootUiSchema": {
                      "ui:functions": [
                        {
                          "ui:field": "DependentBooleanField",
                          "ui:options": {
                            "booleanField": "editors",
                            "booleanDefiner": "leg"
                          }
                        },
                        {
                          "ui:field": "ArrayCombinerField"
                        }
                      ],
                      "ui:field": "TableField",
                      "ui:options": {
                        "specialRules": "legEditors",
                        "ui:buttonsDesktopLayout": true,
                        "ui:deleteHelp": "Poista laskijan nimi",
                        "buttons": [
                          {
                            "fn": "add",
                            "label": "Lisää laskija"
                          }
                        ]
                      },
                      "items": {
                        "ui:functions": {
                          "ui:field": "ContextInjectionField",
                          "ui:options": {
                            "injections": {
                              "/ui:options/rules/0/regexp": "^%{/creator}$"
                            }
                          }
                        },
                        "ui:field": "DependentDisableField",
                        "ui:options": {
                          "rules": [
                            {
                              "disableDefiner": "leg",
                              "disableField": "editors",
                              "regexp": "creator is injected here",
                              "inlineHelp": "Sinulla täytyy olla muokkausoikeus.",
                              "disabledValueToDisplay": true
                            },
                            {
                              "disableDefiner": "leg",
                              "disableField": "editors",
                              "regexp": "^((?!(MA\\.\\d)).)*$"
                            }
                          ]
                        }
                      }
                    }
                  },
                  "legEditorSizeFixer": {
                    "fields": [
                      "_legEditor"
                    ],
                    "title": "",
                    "rootUiSchema": {
                      "ui:grid": {
                        "lg": 6,
                        "md": 6,
                        "sm": 9,
                        "xs": 12
                      }
                    }
                  }
                }
              }
            }
          },
          "eventTime": {
            "fields": [
              "dateBegin",
              "timeStart",
              "timeEnd"
            ],
            "title": "",
            "rootUiSchema": {
              "ui:grid": {
                "rows": [
                  [
                    "dateBegin",
                    "timeStart",
                    "timeEnd"
                  ]
                ],
                "lg": {
                  "dateBegin": 3,
                  "timeStart": 2,
                  "timeEnd": 2
                },
                "md": {
                  "dateBegin": 4,
                  "timeStart": 2,
                  "timeEnd": 2
                },
                "sm": {
                  "dateBegin": 5,
                  "timeStart": 3,
                  "timeEnd": 3
                },
                "xs": 12
              }
            }
          }
        }
      },
      "namedPlaceNotes": {
        "ui:widget": "textarea",
        "ui:options": {
          "rows": 3
        },
        "ui:help": "Kirjaa tähän pysyviä reittiin liittyviä seikkoja"
      },
      "dateBegin": {
        "ui:widget": "DateWidget",
        "ui:options": {
          "showButtons": true
        },
        "ui:help": "Kirjoita laskentapäivämäärä tai valitse päivämäärä kalenterista tai pikavalikolla"
      },
      "timeStart": {
        "ui:widget": "TimeWidget",
        "ui:options": {
          "showTimeList": false
        },
        "ui:help": "Kirjoita laskennan aloituksen ja lopetuksen kellonajat"
      },
      "timeEnd": {
        "ui:widget": "TimeWidget",
        "ui:options": {
          "showTimeList": false
        }
      },
      "legPublic": {
        "ui:options": {
          "allowUndefined": false
        },
        "ui:help": "Tarvittaessa voit piilottaa havainnoijien nimet avoimesta aineistosta valitsemalla \"Ei\"-vaihtoehdon. Havainnoijien nimet ovat aina viranomaisten käytettävissä."
      },
      "notes": {
        "ui:widget": "textarea",
        "ui:options": {
          "rows": 2
        }
      },
      "censusHinderedByEnvironmentalFactors": {
        "ui:help": "Valitse <i>Kyllä</i>, jos sää jollain tavoin haittasi laskentaa. Kirjoita huomautuksiin miten sää haittasi"
      }
    },
    "gatherings": {
      "items": {
        "units": {
          "items": {
            "identifications": {
              "items": {
                "taxonID": {
                  "ui:widget": "HiddenWidget"
                },
                "taxonVerbatim": {
                  "ui:help": "<p>Lisää pisteen parihavainnot laji kerrallaan. Kirjaa kaikki yhden lajin havainnot samalta pisteeltä yhdelle riville. Voit ilmoittaa havaintoja nisäkkäistä sekä vesi- ja lokkilinnuista vain, jotka olet aikaisemmin valinnut kirjanneesi kaikki havainnot näistä lajiryhmistä.  </p> <p>Kirjoita vasemmanpuolimmaiseen sarakkeeseen lajin nimi. Järjestelmässä on automaattinen nimentunnistin eli jos esimerkiksi aloitat kirjoittamaan ”herne…”, niin järjestelmä tarjoaa hernekerttu-vaihtoehtoa. Valitse oikea laji. Mikäli lajinimisarakkeessa on oikeassa reunassa kolmio, järjestelmä ei ole tunnistanut lajinimeä ja havaintoerää ei voi tallentaa. Vastaavasti vihreä V-merkki tarkoittaa, että lajinimi on tunnistettu järjestelmän puolesta.</p>"
                }
              }
            },
            "ui:field": "AutosuggestField",
            "ui:options": {
              "autosuggestField": "taxon",
              "allowNonsuggestedValue": false,
              "suggestionInputField": "identifications_0_taxonVerbatim",
              "suggestionValueField": "identifications_0_taxonID",
              "suggestionReceivers": {
                "identifications_0_taxonVerbatim": "value",
                "identifications_0_taxonID": "key"
              },
              "query": {
                "informalTaxonGroup": "MVL.1,MVL.2",
                "onlyFinnish": true
              }
            },
            "ui:grid": {
              "lg": 3,
              "md": 3,
              "sm": 4,
              "xs": 12
            },
            "recordBasis": {
              "ui:widget": "HiddenWidget"
            },
            "unitFact": {
              "pairCountInner": {
                "ui:help": "Merkitse 50 m säteen sisäpuolella havaittu parimäärä lajille"
              },
              "pairCountOuter": {
                "ui:help": "Merkitse 50 m säteen ulkopuolella ja ylilentävinä havaittu parimäärä lajille"
              },
              "pointCountFlock": {
                "ui:help": "Parvissa havaittujen yksilöiden määrät. Erottele parvet toisistaan pilkulla, esimerkiksi 9,15,3. Merkitse pesiviksi pareiksi tulkittujen parvien parimäärät myös Pari sisällä tai Pari ulkona -kenttään.",
                "ui:helpPlacement": "left"
              }
            },
            "ui:order": [
              "identifications",
              "*",
              "atlasCode"
            ]
          },
          "ui:childFunctions": {
            "ui:field": "FlatField",
            "ui:options": {
              "fields": [
                "identifications",
                "unitFact"
              ]
            }
          },
          "ui:field": "TableField"
        },
        "ui:order": [
          "*",
          "gatheringFact",
          "notes",
          "units"
        ],
        "geometry": {
          "ui:field": "HiddenField"
        },
        "notes": {
          "ui:help": "Kirjoita tähän biotoopin muutoksen syy tai muita pisteeseen liittyviä huomioita"
        },
        "gatheringFact": {
          "pointCountHabitat": {
            "ui:help": "Valitse valikosta pisteen 50 metrin säteen sisällä olevaa ympäristöä parhaiten kuvaava biotooppi"
          }
        },
        "ui:grid": {
          "lg": {
            "notes": 6,
            "gatheringFact": 6,
            "units": 12
          },
          "md": {
            "notes": 6,
            "gatheringFact": 6,
            "units": 12
          },
          "sm": {
            "notes": 6,
            "gatheringFact": 6,
            "units": 12
          },
          "xs": {
            "notes": 12,
            "gatheringFact": 12,
            "units": 12
          }
        }
      },
      "ui:functions": {
        "ui:field": "MapArrayField",
        "ui:settings": [
          "/mapOptions/tileLayerName",
          "/mapOptions/overlayNames",
          "/mapOptions/tileLayerOpacity",
          "/mapOptions/tileLayers"
        ],
        "ui:options": {
          "geometryField": "geometry",
          "mapSizes": {
            "lg": 4,
            "md": 4,
            "sm": 6,
            "xs": 6
          },
          "mapOptions": {
            "tileLayerName": "maastokartta",
            "controls": {
              "location": false,
              "draw": {
                "clear": true,
                "undo": false,
                "redo": false
              }
            },
            "tileLayerOpacity": 0.5,
            "draw": {
              "marker": true,
              "polygon": false,
              "circle": false,
              "polyline": false,
              "rectangle": false,
              "single": true
            }
          },
          "idToFocusAfterNavigate": "root_gatherings_%{context[\"root_gatherings.activeIdx\"]}_units_0",
          "idToScrollAfterNavigate": "root_gatherings_%{context[\"root_gatherings.activeIdx\"]}__header",
          "activeIdx": 0,
          "minHeight": 500,
          "help": "<p>Karttatyökalusta löytyy useita toimintoja. Vasemmasta yläkulmasta kolmen päällekkäisen arkin symbolin kohdalta voit valita erilaisia karttapohjia. Oletuksena on mm. karttapaikasta tuttu maastokartta. Ortokuva –vaihtoehto antaa ilmakuvan kohteesta. Karttapohjavalikon alapuolella olevalla ”Suurennuslasi” –työkalulla voit etsiä kohdetta tämän nimen perusteella. Plus- ja miinus-merkeillä voit lähentää tai loitontaa karttakuvaa (zoomaus sisään tai ulos).  </p> <p>Kartan oikeasta yläkulmasta löydät kolme erilaista piirtotyökalua. Näillä voit piirtää kartalle i) laskentapisteen, ii) lisätä laskentapisteen koordinaattien perusteella tai iii) tyhjentää kartan merkinnöistä.  </p> <p>”Lisää nasta” -työkalulla voit lisätä laskentapisteen kartalle. Voit myös siirtää karttapistettä klikkaamalla sitä hiirellä kahdesti tai painamalla sitä hiiren vasemmalla näppäimellä ja valitse ”Muokkaa kuvio”, jolloin sen ympärille muodostuu katkoviivakehikko. Tällöin voit siirtää pisteen haluamaasi paikkaan valitsemalla kohde hiirellä ja pitämällä hiiren näppäin pohjassa siihen asti, kun olet siirtänyt kohteen haluamaasi paikkaan.  </p> <p>”Tyhjennä kartta” –työkalu on kätevä tapa poistaa kartan aikaisemmat merkinnät esimerkiksi havainnointiruutu, jos pistereitin aikaisemmat laskentapaikat eivät ole olleet järjestelmässä.</p>"
        }
      },
      "ui:field": "SingleActiveArrayField",
      "ui:title": "Piste %{idx}",
      "ui:options": {
        "renderer": "accordion",
        "affixed": true,
        "headerClassName": "darker-bottom-border",
        "canAdd": false,
        "removable": false
      }
    },
    "ui:shortcuts": {
      "alt": {
        "fn": "help",
        "delay": 1
      },
      "Enter": {
        "fn": "navigate"
      },
      "shift+Enter": {
        "fn": "navigate",
        "reverse": true
      },
      "ctrl+Enter": {
        "fn": "textareaRowInsert"
      },
      "alt+ ": {
        "fn": "navigate"
      },
      "alt+shift+ ": {
        "fn": "navigate",
        "reverse": true
      },
      "alt+PageDown": {
        "fn": "navigateArray",
        "target": "root_gatherings",
        "targetLabel": "väliin"
      },
      "alt+PageUp": {
        "fn": "navigateArray",
        "reverse": true,
        "target": "root_gatherings",
        "targetLabel": "väliin"
      },
      "alt+ArrowRight": {
        "fn": "navigateArray",
        "target": "root_gatherings",
        "targetLabel": "väliin"
      },
      "alt+ArrowLeft": {
        "fn": "navigateArray",
        "reverse": true,
        "target": "root_gatherings",
        "targetLabel": "väliin"
      },
      "alt+ArrowUp": {
        "fn": "navigateArray",
        "reverse": true,
        "target": "root_gatherings_%{context[\"root_gatherings.activeIdx\"]}_units",
        "targetLabel": "havaintoon"
      },
      "alt+ArrowDown": {
        "fn": "navigateArray",
        "target": "root_gatherings_%{context[\"root_gatherings.activeIdx\"]}_units",
        "targetLabel": "havaintoon"
      },
      "alt+h": {
        "fn": "navigateArray",
        "reverse": true,
        "target": "root_gatherings",
        "targetLabel": "väliin"
      },
      "alt+j": {
        "fn": "navigateArray",
        "target": "root_gatherings_%{context[\"root_gatherings.activeIdx\"]}_units",
        "targetLabel": "havaintoon"
      },
      "alt+k": {
        "fn": "navigateArray",
        "reverse": true,
        "target": "root_gatherings_%{context[\"root_gatherings.activeIdx\"]}_units",
        "targetLabel": "havaintoon"
      },
      "alt+l": {
        "fn": "navigateArray",
        "target": "root_gatherings",
        "targetLabel": "väliin"
      },
      "alt+n": {
        "fn": "navigateArray"
      },
      "alt+p": {
        "fn": "navigateArray",
        "reverse": true
      },
      "alt+Insert": {
        "fn": "insert"
      },
      "alt+i": {
        "fn": "insert"
      },
      "alt+Delete": {
        "fn": "delete"
      },
      "alt+d": {
        "fn": "delete"
      },
      "alt+u": {
        "fn": "insert",
        "target": "root_gatherings_%{context[\"root_gatherings.activeIdx\"]}_units",
        "targetLabel": "havainto"
      },
      "alt+m": {
        "fn": "splitLineTransectByMeters",
        "target": "root_gatherings"
      }
    },
    "ui:order": [
      "*",
      "gatheringEvent",
      "gatherings"
    ],
    "ui:field": "InjectField",
    "ui:options": {
      "injections": {
        "fields": [
          "editors",
          "notes"
        ],
        "target": "gatheringEvent"
      }
    },
    "ui:annotations": {
      "formId": "MHL.21",
      "container": "modal",
      "adminOnly": true,
      "add": {
        "type": "MAN.typeOpinion"
      },
      "buttonsPath": "/gatheringEvent"
    },
    "notes": {
      "ui:widget": "textarea",
      "ui:options": {
        "rows": 3
      },
      "ui:help": "Tähän voit lisätä huomautuksia kyseisestä laskentakerrasta, esimerkiksi säästä"
    }
  },
  "validators": {
    "gatheringEvent": {
      "presence": {
        "allowEmpty": false
      },
      "properties": {
        "leg": {
          "presence": {
            "message": "Vähintään yksi havainnoija täytyy ilmoittaa."
          },
          "length": {
            "minimum": 1,
            "message": "Vähintään yksi laskija täytyy ilmoittaa"
          }
        },
        "dateBegin": {
          "datetime": {
            "earliest": "1000-01-01",
            "tooEarly": "Päivämäärä on liian varhainen. Varhaisin mahdollinen on %{date}",
            "latest": "now",
            "notValid": "@dateInvalid",
            "tooLate": "@dateInTheFutureValidation"
          },
          "presence": {
            "message": "Päivämäärä on pakollinen"
          },
          "monthDayRange": {
            "ranges": [
              {
                "earliestMonth": 4,
                "earliestDay": 15,
                "latestMonth": 7,
                "latestDay": 15
              }
            ],
            "message": "Päivämäärä on laskentajaksojen ulkopuolella.",
            "dateOnly": true
          }
        },
        "timeStart": {
          "presence": {
            "message": "Aloitusaika pitää ilmoittaa"
          }
        },
        "timeEnd": {
          "compareNumerically": {
            "greaterThan": "timeStart",
            "message": "Loppuajan tulee olla alkuaikaa myöhemmin"
          },
          "presence": {
            "message": "Lopetusaika pitää ilmoittaa"
          }
        }
      }
    },
    "gatherings": {
      "presence": {
        "message": "Vähintään yksi paikka täytyy ilmoittaa.",
        "allowEmpty": false
      },
      "items": {
        "properties": {
          "geometry": {
            "geometry": {
              "maximumSize": 10,
              "message": {
                "missingGeometries": "Paikalla täytyy olla vähintään yksi kuvio.",
                "invalidBoundingBoxHectares": "Liian iso alue. Maksimi on %{max} hehtaaria",
                "notGeometry": "Paikalla täytyy olla vähintään yksi kuvio.",
                "missingType": "Paikalla täytyy olla vähintään yksi kuvio.",
                "invalidRadius": "Paikalla täytyy olla vähintään yksi kuvio.",
                "invalidCoordinates": "Paikalla täytyy olla vähintään yksi kuvio.",
                "invalidGeometries": "Paikalla täytyy olla vähintään yksi kuvio.",
                "noOverlap": "Paikalla täytyy olla vähintään yksi kuvio."
              },
              "boundingBoxMaxHectares": 5000000,
              "requireShape": true,
              "includeGatheringUnits": true
            }
          },
          "notes": {
            "crossCheck": {
              "check": "/gatheringFact/pointCountHabitat",
              "mustHaveValue": true,
              "onlyWhenCheckIn": [
                "MY.pointCountHabitat17"
              ],
              "message": "Kirjoita Biotooppi ”Muu” Huomautuksiin."
            }
          },
          "units": {
            "items": {
              "duplicateCheck": {
                "key": "/identifications/0/taxonID",
                "messageKey": "/identifications/0/taxonVerbatim",
                "arrayPath": "../units",
                "message": {
                  "isDuplicate": "%{value} on ilmoitettu monta kertaa"
                }
              },
              "properties": {
                "unitFact": {
                  "properties": {
                    "pairCountInner": {
                      "crossCheck": {
                        "check": "pairCountOuter",
                        "message": "Pitää olla lukumäärä joko Pari sisällä tai Pari ulkona kohdassa",
                        "mustHaveValue": true,
                        "onlyWhenNoCheck": true
                      }
                    },
                    "pointCountFlock": {
                      "format": {
                        "pattern": "^([0-9]*)?(,[0-9]+)*$",
                        "message": " Ilmoita parvien koot pilkulla erotettuna"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  },
  "warnings": {
    "gatheringEvent": {
      "properties": {
        "dateBegin": {
          "remote": {
            "validator": "noExistingGatheringsInNamedPlace",
            "message": "Kyseiselle laskentajaksolle on jo tehty laskenta valitulta reitiltä."
          },
          "monthDayRange": {
            "ranges": [
              {
                "earliestMonth": 5,
                "earliestDay": 20,
                "latestMonth": 6,
                "latestDay": 20
              }
            ],
            "message": "Päivämäärä on laskentajaksojen ulkopuolella.",
            "dateOnly": true
          }
        },
        "timeEnd": {
          "timeDifference": {
            "compareTo": "timeStart",
            "maxDifference": 360,
            "minDifference": 150,
            "message": {
              "tooSmall": "Oletko varma, että laskennan kesto on näin lyhyt?",
              "tooBig": "Oletko varma, että laskennan kesto on näin pitkä?"
            }
          }
        }
      }
    },
    "gatherings": {
      "items": {
        "properties": {
          "units": {
            "length": {
              "minimum": 1,
              "tooShort": "Oletko varma että pisteestä ei ole yhtäkään havaintoa?"
            },
            "presence": {
              "message": "Oletko varma että pisteestä ei ole yhtäkään havaintoa?"
            }
          }
        }
      }
    }
  },
  "attributes": {
    "id": "MHL.75"
  }
}
