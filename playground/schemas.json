{
	"id": "JX.519",
	"title": "Tripreport",
	"description": "With this form you can log spceimens that you've seen.",
	"uiSchema": {
		"ui:order": ["gatheringEvent", "gatherings", "temp", "ready"],
		"ui:field": "inject",
		"ui:options": {
			"injections": {
				"fields": ["editors"],
				"target": "gatheringEvent"
			},
			"uiSchema": {
				"ui:field": "injectDefaultValue",
				"ui:options": {
					"fields": ["dateBegin", "dateEnd"],
					"target": "gatherings",
					"source": "gatheringEvent"
				}
			}
		},
		"gatheringEvent": {
			"ui:field": "nested",
			"ui:options": {
				"legWrapper": {
					"title": "Havainnoitsijat",
					"fields": ["leg", "legPublic", "editors"],
					"uiSchema": {
						"ui:field": "nested",
						"ui:options": {
							"": {
								"fields": ["leg", "editors"],
								"uiSchema": {
									"ui:field": "dependentBoolean",
									"ui:options": {
										"booleanField": "editors",
										"booleanDefiner": "leg",
										"uiSchema": {
											"ui:field": "arrayCombiner",
											"ui:options": {
												"uiSchema": {
													"items": {
														"leg": {
															"ui:field": "autosuggestWidget",
															"ui:options": {
																"autosuggestField": "friends",
																"allowNonsuggestedValue": true,
																"suggestionReceive": "key"
															}
														},
														"ui:field": "dependentDisable",
														"ui:options": {
															"disableDefiner": "leg",
															"disableField": "editors",
															"regexp": "^MA\\.\\d+$"
														}
													},
													"ui:field": "table"
												}
											}
										}
									}
								}
							}
						}
					}
				},
				"eventTime": {
					"title": "Aika",
					"fields": [
						"dateBegin",
						"dateEnd"
					],
					"uiSchema": {
						"ui:field": "expandable",
						"ui:options": {
							"additionalFields": [
								"dateEnd"
							],
							"uiSchema": {
								"ui:field": "horizontal",
								"dateBegin": {
									"ui:widget": "dateTime"
								},
								"dateEnd": {
									"ui:widget": "dateTime"
								}
							},
							"expanderButtonText": "Ilmoita aikaväli",
							"contractorButtonText": "Piilota aikavälin loppu"
						}
					}
				}
			}
		},
		"gatherings": {
			"ui:field": "mapArray",
			"items": {
				"ui:order": ["wgs84Geometry", "eventTime", "units", "treeWrapper", "imagesWrapper"],
				"ui:field": "nested",
				"ui:options": {
					"eventTime": {
						"title": "Aika",
						"fields": ["dateBegin", "dateEnd"],
						"uiSchema": {
							"ui:field": "expandable",
							"ui:options": {
								"additionalFields": ["dateEnd"],
								"uiSchema": {
									"ui:field": "horizontal",
									"dateBegin": {
										"ui:widget": "dateTime"
									},
									"dateEnd": {
										"ui:widget": "dateTime"
									}
								},
								"expanderButtonText": "Ilmoita aikaväli",
								"contractorButtonText": "Piilota aikavälin loppu"
							}
						}
					},
					"imagesWrapper": {
						"title": "Kuvat",
						"fields": ["image", "rights"],
						"uiSchema": {
							"ui:field": "horizontal"
						}
					},
					"treeWrapper": {
						"title": "Havaintopaikan tiedot",
						"fields" : ["tree"],
						"uiSchema": {
							"tree": {
							"ui:field": "tree",
							"ui:options": {
								"tree": {
									"children": {
										"K2": {
											"children": {
												"K3": {
													"children": {
														"K4": {},
														"K5": {},
														"K6": {
															"children": {
																"K7": {},
																"K8": {}
															},
															"order": ["K7","K8"]
														}
													},
													"order": ["K4, K5", "K6"]
												},
												"K9": {
													"children": {
														"K10": {
															"children": {
																"K11": {},
																"K12": {}
															}
														},
														"K13": {}
													},
													"order": ["K10", "K13"]
												}
											},
											"order": ["K9, K3"]
										},
										"K14": {
											"children": {
												"K15": {
													"children": {
														"K16": {
															"children": {
																"K17": {},
																"K18": {}
															}
														},
														"K19": {}
													}
												},
												"K20": {}
											}
										}
									},
									"order": ["K14", "K2"]
								},
								"labels": [
									"eka taso", "toka taso", "kolmas taso"
								],
								"uiSchema": {
									"ui:field": "horizontal"
								}
							}
							}
						}
					}
				},
				"units": {
					"ui:field": "autoArray",
					"items": {
						"ui:field": "scoped",
						"ui:options": {
							"uiSchema": {
								"ui:field": "expandable",
								"ui:options": {
									"expanderButtonText": "Näytä lisää muuttujia",
									"contractorButtonText": "Näytä vähemmän muuttujia",
									"uiSchema": {
										"ui:field": "autosuggest",
										"ui:options": {
											"autosuggestField": "taxon",
											"suggestionInputField": "informalNameString",
											"suggestionReceivers": {
												"informalNameString": "value",
												"unitType": "payload.taxonGroups",
												"taxonID": "key"
											},
											"uiSchema": {
												"ui:field": "horizontal"
											}
										}
									}
								}
							},
							"fieldScopes": {
								"informalNameString": {
									"+": {
										"fields": [
											"unitType"
										],
										"fieldScopes": {
											"unitType": {
												"MVL.1": {
													"fields": [
														"ring",
														"sex",
														"notes"
													]
												},
												"MVL.2": {
													"fields": [
														"age",
														"notes"
													],
													"uiSchema": {
														"ui:options": {
															"additionalFields": [
																"alive",
																"notes"
															]
														}
													}
												},
												"MVL.21": {
													"fields": [
														"count",
														"alive"
													],
													"uiSchema": {
														"ui:options": {
															"additionalFields": [
																"notes"
															]
														}
													}
												},
												"MVL.26": {
													"fields": [
														"age",
														"alive"
													],
													"uiSchema": {
														"ui:options": {
															"additionalFields": [
																"notes"
															]
														}
													}
												},
												"+": {
													"refs": ["recordBasis"],
													"uiSchema": {"ui:options": {
															"uiSchema": {
																"ui:options": {
																	"uiSchema": {
																		"unitType": {
																			"ui:field": "hidden"
																		}
																	}
																}
															}
														}
													}

												}
											}
										}
									}
								}
							},
							"definitions": {
								"recordBasis": {
									"fields": ["recordBasis"],
									"fieldScopes": {
										"recordBasis": {
											"observationSeen": {
												"fields": [
													"seenField",
													"seenField2"
												]
											},
											"observationHeard": {
												"fields": [
													"heardField",
													"heardField2"
												]
											},
											"preservedSpecimen": {
												"fields": ["identification"],
												"uiSchema": {
													"ui:options": {
														"uiSchema": {
															"ui:options": {
																"uiSchema": {
																	"identification": {
																		"items": {
																			"ui:field": "autosuggest",
																			"ui:options": {
																				"autosuggestField": "taxon",
																				"suggestionInputField": "taxon",
																				"suggestionReceivers": {
																					"taxon": "value",
																					"taxonID": "key"
																				},
																				"uiSchema": {
																					"ui:field": "horizontal",
																					"taxonID": {
																						"ui:widget": "hidden"
																					},
																					"detDate": {
																						"ui:widget": "dateTime"
																					}
																				}
																			}
																		}
																	}
																}
															}
														}
													}
												}
											}
										}
									}
								}
							}
						}
					}
				}
			}
		}
	},
	"schema": {
		"type": "object",
		"properties": {
			"editors": {
				"type": "array",
				"title": "Anna käyttäjälle muokkausoikeus?",
				"items": {
					"type": "string"
				}
			},
			"gatheringEvent": {
				"title": "Perustiedot",
				"type": "object",
				"properties": {
					"leg": {
						"type": "array",
						"title": "Havainnoitsijat",
						"items": {
							"type": "string"
						}
					},
					"legPublic": {
						"type": "boolean",
						"title": "Näytetäänkö nimet julkisesti?"
					},
					"dateBegin": {
						"type": "string",
						"title": "Havaintoaika"
					},
					"dateEnd": {
						"type": "string",
						"title": "Havaintoajan loppu"
					}
				},
				"required": ["dateBegin"]
			},
			"gatherings": {
				"type": "array",
				"items": {
					"title": "Havainnot",
					"type": "object",
					"properties": {
						"dateBegin": {
							"type": "string",
							"title": "Havaintoaika"
						},
						"dateEnd": {
							"type": "string",
							"title": "Havaintoajan loppu"
						},
						"units": {
							"type": "array",
							"title": "Havainnot",
							"items": {
								"type": "object",
								"properties": {
									"informalNameString": {
										"title": "Taksoni",
										"type" : "string"
									},
									"unitType": {
										"type": "array",
										"items": {
											"type": "string"
										}
									},
									"taxonID": {
										"type": "string"
									},
									"age": {
										"type": "string",
										"title": "Ikä"
									},
									"sex": {
										"type": "string",
										"title": "Sukupuoli",
										"enum": [
											"",
											"MY.sexM",
											"MY.sexF",
											"MY.sexU",
											"MY.sexN",
											"MY.sexX",
											"MY.sexW",
											"MY.sexE",
											"MY.sexC"
										],
										"enumNames": [
											"",
											"M - Male",
											"F - Female",
											"U - Unknown",
											"N - Not applicable",
											"X - miXed",
											"W - Worker",
											"E - multiplE",
											"C - Conflicting"
										]
									},
									"notes": {
										"type": "string",
										"title": "Muistiinpanot"
									},
									"count": {
										"type": "string",
										"title": "Lukumäärä"
									},
									"alive": {
										"type": "boolean",
										"title": "Elossa?"
									},
									"ring": {
										"type": "string",
										"title": "Rengas"
									},
									"recordBasis": {
										"title": "Näytteen havaitsemistapa",
										"type": "string",
										"enum": ["", "observationHeard", "observationSeen", "preservedSpecimen"],
										"enumNames": ["", "Kuultu", "Nähty", "Otettu talteen"]
									},
									"identification": {
										"title": "Tunnistukset",
										"type": "array",
										"items": {
											"type": "object",
											"properties": {
												"taxon": {
													"title": "Taksoni",
													"type": "string"
												},
												"taxonID": {
													"type": "string"
												},
												"det": {
													"type": "string"
												},
												"detDate": {
													"type": "string"
												}
											}
										}
									},
									"seenField": {
										"type": "string",
										"title": "Täytä jos nähty"
									},
									"seenField2": {
										"type": "string",
										"title": "Täytä tääkin jos nähty"
									},
									"heardField": {
										"type": "string",
										"title": "Täytä jos kuultu"
									},
									"heardField2": {
										"type": "string",
										"title": "Täytä tääkin jos kuultu"
									}
								},
								"required": []
							}
						},
						"image": {
							"type": "string",
							"title": "Raahaa tähän kuvat tai valitse tiedosto koneeltasi [Browse]"
						},
						"rights": {
							"type": "string",
							"title": "Kuivien käyttöoikeus [pakollinen]"
						},
						"wgs84Geometry": {
							"type": "object",
							"properties": {}
						},
						"tree": {
							"type": "string",
							"enum": ["", "K2", "K3", "K4", "K5", "K6", "K7", "K8", "K9", "K10", "K11", "K12", "K13", "K14", "K15", "K16", "K17", "K18", "K19", "K20", "K21", "K22", "K23", "K24", "K25", "K26", "K27", "K28", "K29", "K30", "K31", "K32", "K33", "K34", "K35", "K36", "K37", "K38", "K39", "K40"],
							"enumNames": ["", "2", "3", "4", "5", "6", "7", "8", "9", "10", "11", "12", "13", "14", "15", "16", "17", "18", "19", "20", "21", "22", "23", "24", "25", "26", "27", "28", "29", "30", "31", "32", "33", "34", "35", "36", "37", "38", "39", "40"],
							"title": " "
						}
					}
				}
			},
			"temp": {
				"type": "boolean"
			},
			"ready": {
				"type": "boolean"
			}
		}
	},
	"formData": {
		"gatheringEvent": {
			"leg": [
				"MA.3",
				"b",
				"c"
			],
			"legPublic": false,
			"dateEnd": "2016-06-22T11:08:54.044Z"
		},
		"gatherings": [
			{
				"units": [
					{
						"informalNameString": "susi",
						"unitType": [
							"MVL.2"
						],
						"taxonID": "MX.46549",
						"recordBasis": "preservedSpecimen",
						"notes": "Muistiinpanot"
					}
				],
				"dateBegin": "2016-05-11T11:08:54.044Z",
				"kartta": "",
				"image": "",
				"wgs84Geometry": {
					"type": "Point",
					"coordinates": [
						24.92990638910176,
						60.17085995166927
					]
				},
				"dateEnd": "",
				"rights": "",
				"tree": ""
			},
			{
				"kartta": "",
				"units": [],
				"image": "",
				"rights": "",
				"wgs84Geometry": {
					"type": "Point",
					"coordinates": [
						24.934855632550473,
						60.171278498063046
					]
				}
			}
		],
		"temp": false,
		"ready": false,
		"editors": [
			"MA.3",
			"c",
			"d"
		]
	}
}
